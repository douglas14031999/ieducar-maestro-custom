import{d as Ae,r as p,E as wt,g as $,z as tt,o as n,m as F,s as j,c as d,a as e,$ as he,j as m,p as v,A as l,w as fe,M as Ue,t as u,G as $t,K as mt,u as ot,a1 as st,x as Se,L as Ct,i as kt,R as vt,Y as Qe,F as we,l as ke,q as ce,a8 as St,_ as ft,a2 as gt,a0 as Tt,n as Vt,V as At}from"./vendor.1ymnu820c3.js";import{u as Ve,b as Q,X as K,_ as V,f as Be,w as Nt,d as bt,a as lt,M as Rt,s as It,N as it,q as Et,O as zt,P as dt,I as je,J as Oe,K as Dt,Q as Pt,L as Mt,R as ut,T as ct,U as Ot,C as xt,D as ht,V as Ut,W as jt,Y as Bt,e as Me,Z as pt,$ as Ft,a0 as Lt}from"./common.1ymnu820c3.js";import{d as yt,e as Wt,f as Gt,h as Ht,g as qt,t as Yt,i as Jt,j as Xt,k as Zt,u as Kt,m as Qt,n as eo,o as to,q as _t,r as oo,s as so,v as lo,w as ao,x as no,y as ro,z as io}from"./shared/prepregistrations-subscription/preregistrations.1ymnu820c3.js";import{f as et}from"./js-file-download.1ymnu820c3.js";const uo={key:0},co={class:"m-auto",style:{"max-width":"740px"}},po={key:0,class:"mt-4 text-danger font-weight-bold"},mo={key:1,class:"mt-4 font-weight-bold"},vo={key:2,class:"mt-4 font-weight-bold"},fo={key:3,class:"form-group"},go={key:4,class:"form-group"},bo={key:5},Eo={class:"text-danger"},xo=["innerHTML"],ho={class:"d-flex justify-content-center mt-4"},yo={key:1},_o={key:2},wo={key:0,class:"mt-4 font-weight-bold"},$o={key:1,class:"mt-4 font-weight-bold"},Co={key:2,class:"mt-4 font-weight-bold"},ko={key:3,class:"mt-4"},So={class:"text-danger"},To=["innerHTML"],Vo={class:"row justify-content-center d-flex mt-4"},Ao=Ae({__name:"PreRegistrationBatch",props:{filter:{},preregistrations:{},step:{},processYear:{},modelValue:{type:Boolean}},emits:["load"],setup($e,{emit:I}){const le=I,z=$e,{loader:_}=Ve(),{loader:P}=Ve(),{loader:A}=Ve(),{loader:C,data:h}=Q(),k=p(""),D=p(),s=p(!1),M=p(!1),G=p(),q=p(),L=p(!1),W=p(0),ae=wt(z,"modelValue"),B=$(()=>{switch(z.step){case"REJECT":return"Indeferimento em lote";case"ACCEPT":return"Deferimento em lote";case"SUMMON":return"Convoca\xE7\xE3o em lote";default:return""}});tt(()=>{ae.value&&z.step==="ACCEPT"&&y()});const ne=()=>{ae.value=!1,k.value="",h.value=[],D.value=void 0,s.value=!1,M.value=!1,G.value=null,q.value=null,L.value=!1,W.value=0},H=()=>{ne(),le("load")},O=()=>{if(!Number(D.value)){M.value=!0,G.value="\xC9 necess\xE1rio selecionar uma turma para realizar o Deferimento da pr\xE9-matr\xEDcula.",q.value="";return}L.value=!0,_(()=>Wt({ids:z.preregistrations.map(f=>Number(f)),classroom:Number(D.value)})).then(({acceptPreRegistrations:f})=>{f&&(s.value=!0,W.value=f.length)}).catch(f=>{f.response.data.errors&&f.response.data.errors.length?(M.value=!0,s.value=!0,G.value="N\xE3o foi poss\xEDvel realizar o deferimento de todos os(as) alunos(as)",q.value=f.response.data.errors.map(i=>{var w;return(w=i.extensions)==null?void 0:w.message}).join("<br>"),f.response.data.data.acceptPreRegistrations&&(W.value=f.response.data.data.acceptPreRegistrations.length)):f.errors&&f.errors.length&&(M.value=!0,G.value="N\xE3o foi poss\xEDvel realizar o deferimento de todos os(as) alunos(as)",q.value=f.errors.map(i=>{var w;return(w=i.extensions)==null?void 0:w.message}).join("<br>"))}).finally(()=>{L.value=!1})},ge=()=>{L.value=!0,P(()=>Gt({ids:z.preregistrations,justification:k.value})).then(({rejectPreRegistrations:f})=>{f&&(s.value=!0,W.value=f.length)}).catch(f=>{if(f.errors&&f.errors.length){M.value=!0,G.value=f.errors[0].message,q.value=f.errors.map(i=>{var w;return(w=i.extensions)==null?void 0:w.message}).join("<br>");return}}).finally(()=>{L.value=!1})},ee=()=>{L.value=!0,A(()=>Ht({ids:z.preregistrations,justification:k.value})).then(({summonPreRegistrations:f})=>{f&&(s.value=!0,W.value=f.length)}).catch(f=>{f.response.data.errors&&f.response.data.errors.length&&(M.value=!0,G.value="N\xE3o foi poss\xEDvel realizar a convoca\xE7\xE3o de todos os(as) respons\xE1veis(as)",q.value=f.response.data.errors.map(i=>{var w;return(w=i.extensions)==null?void 0:w.message}).join("<br>"))}).finally(()=>{L.value=!1})},y=()=>{h.value=[],C(()=>yt({school:z.filter.school,grade:z.filter.grade,year:z.processYear}))};return(f,i)=>(n(),F(Be,{modelValue:l(ae),"onUpdate:modelValue":i[3]||(i[3]=w=>$t(ae)?ae.value=w:null),large:!0,title:B.value,"overflow-visible":!s.value&&f.step==="ACCEPT","no-footer":""},{body:j(()=>[f.preregistrations&&s.value===!1?(n(),d("div",uo,[e("div",co,[f.step==="REJECT"?(n(),d("div",po,i[4]||(i[4]=[he(" Tem certeza que deseja indeferir as pr\xE9-matr\xEDculas? "),e("hr",null,null,-1)]))):m("",!0),f.step==="ACCEPT"?(n(),d("div",mo,[i[5]||(i[5]=he(" Selecione a turma que deseja matricular os(as) alunos(as) para completar o deferimento das pr\xE9-matr\xEDculas dos(as) alunos(as). ")),i[6]||(i[6]=e("hr",null,null,-1)),v(K,{modelValue:D.value,"onUpdate:modelValue":i[0]||(i[0]=w=>D.value=w),"container-class":"col-12 form-group mt-3",rules:"required",label:"Para qual turma deseja designar os(as) alunos(as)?",name:"classroom",type:"SELECT",errors:M.value,options:l(h)},null,8,["modelValue","errors","options"])])):m("",!0),f.step==="SUMMON"?(n(),d("div",vo,i[7]||(i[7]=[he(" Tem certeza que deseja convocar os respons\xE1veis desta(s) pr\xE9-matr\xEDcula(s)? "),e("hr",null,null,-1)]))):m("",!0),f.step==="SUMMON"?(n(),d("div",fo,[i[8]||(i[8]=e("label",{class:"form-label",for:"summon-justification"},"Observa\xE7\xF5es (opcional)",-1)),fe(e("textarea",{id:"summon-justification","onUpdate:modelValue":i[1]||(i[1]=w=>k.value=w),class:"form-control",rows:"3"},null,512),[[Ue,k.value]])])):m("",!0),f.step==="REJECT"?(n(),d("div",go,[i[9]||(i[9]=e("label",{class:"form-label",for:"reject-justification"},"Justificativa (opcional)",-1)),fe(e("textarea",{id:"reject-justification","onUpdate:modelValue":i[2]||(i[2]=w=>k.value=w),class:"form-control",rows:"3"},null,512),[[Ue,k.value]])])):m("",!0),M.value?(n(),d("div",bo,[e("h2",Eo,u(G.value),1),e("span",{innerHTML:q.value},null,8,xo)])):m("",!0),e("div",ho,[f.step==="SUMMON"?(n(),F(V,{key:0,label:"Convocar respons\xE1veis",loading:L.value,color:"summon",outline:"",class:"ml-3 pmd-custom",icon:"pmd-summon","no-caps":"","no-wrap":"","loading-normal":"",onClick:ee},null,8,["loading"])):m("",!0),f.step==="REJECT"?(n(),F(V,{key:1,label:"Indeferir pr\xE9-matr\xEDculas",loading:L.value,color:"rejected",outline:"",class:"ml-3 pmd-custom",icon:"pmd-rejected","no-caps":"","no-wrap":"","loading-normal":"",onClick:ge},null,8,["loading"])):m("",!0),f.step==="ACCEPT"?(n(),F(V,{key:2,label:"Deferir pr\xE9-matr\xEDculas",loading:L.value,color:"accepted",outline:"",class:"ml-3 pmd-custom",icon:"pmd-accepted","no-caps":"","no-wrap":"","loading-normal":"",onClick:O},null,8,["loading"])):m("",!0)])])])):s.value===!1?(n(),d("div",yo,"Carregando..")):m("",!0),f.preregistrations&&s.value===!0?(n(),d("div",_o,[f.step==="ACCEPT"?(n(),d("div",wo,u(W.value)+" matr\xEDcula(s) deferida(s) com sucesso ",1)):m("",!0),f.step==="REJECT"?(n(),d("div",$o,u(W.value)+" matr\xEDcula(s) indeferida(s) com sucesso ",1)):m("",!0),f.step==="SUMMON"?(n(),d("div",Co,u(W.value)+" matr\xEDcula(s) convocada(s) com sucesso ",1)):m("",!0),M.value?(n(),d("div",ko,[e("h2",So,u(G.value),1),e("span",{innerHTML:q.value},null,8,To)])):m("",!0),e("div",Vo,[v(V,{class:"ml-3 mr-3 w-50",color:"success",label:"Fechar","no-caps":"","no-wrap":"",onClick:H})])])):m("",!0)]),_:1},8,["modelValue","title","overflow-visible"]))}}),No={class:"row m-0 mt-1 filter-gutters mb-md-3"},Ro={class:"col-12 col-md-3 mb-2 mb-md-0"},Io={class:"row m-0 filter-gutters mt-md-4"},zo={class:"col-12 col-md-3 mb-2 mb-md-0"},Do={class:"d-flex m-0 mt-3 filter-gutters flex-column flex-lg-row"},Po={class:"d-flex flex-grow-1"},Mo={class:"d-flex justify-content-end flex-grow-1 mt-2 mt-md-0"},Oo={class:"d-flex flex-column flex-lg-row mb-4"},Uo={class:"mb-3 mb-lg-0"},jo={class:"ml-lg-auto"},Bo={class:"align-items-baseline d-flex font-hind mb-2"},Fo={class:"mr-2"},Lo={key:1,class:"table table-responsive table-striped table-vcenter"},Wo={class:"w-1"},Go={class:"custom-control custom-checkbox"},Ho={key:0},qo={class:"w-1"},Yo={class:"custom-control custom-checkbox"},Jo=["id","value"],Xo=["for"],Zo=["onClick"],Ko={key:0},Qo={class:"align-top"},es={key:1},ts={class:"align-top"},os={key:0},ss={class:"align-top"},ls={key:1},as={class:"align-top"},ns={key:2,class:"row justify-content-center mt-4"},rs={class:"col-12 col-lg-3"},is={class:"row"},ds={class:"row"},us={class:"col-12"},cs=Ae({__name:"PreRegistrationList",setup($e){var Ie;const{dialog:I}=Nt(),{loader:le}=Q(),{loader:z}=Q(),{loader:_,loading:P}=Q(),{loader:A,loading:C}=Q(),h=(Ie=mt())==null?void 0:Ie.appContext,{loader:k,loading:D}=bt(h,p({title:"Aten\xE7\xE3o!",description:"N\xE3o foi poss\xEDvel emitir o relat\xF3rio. Verifique os filtros e tente novamente."})),s=lt(),M=ot(),G=st(),q=$(()=>G),L=p(!1),W=p(),ae=p(null),B=p(!1),ne=p(),H=p(!1),O=p([]),ge=p(),ee=p(),y=p([]),f=p({search:"",process:null,school:null,grade:null,grades:[],canAcceptInBatch:!1,sort:null,year:null,schools:null,processes:[]}),i=p({search:"",process:null,school:null,grade:null,grades:[],sort:null,canAcceptInBatch:!1,year:null,schools:null,processes:[]}),w=p([]),te=p([]),re=p([]),ye=p([]),oe=p(["REGISTRATION","REGISTRATION_RENEWAL","WAITING_LIST"]),Ce=p(["REJECTED","ACCEPTED","WAITING","SUMMONED","IN_CONFIRMATION"]),S=p([]),se=p(25),Te=p([{key:25,label:"25"},{key:50,label:"50"},{key:100,label:"100"},{key:200,label:"200"},{key:400,label:"400"}]),ie=p(!0),_e=p(!1),Z=p({template:1,showStudentShortName:!0,disregardStudentsIeducar:!1}),x=$(()=>O.value.length===0),r=$(()=>i.value.canAcceptInBatch?O.value.length===0:!0),Y=$(()=>O.value.length===0),be=$(()=>{let E=[];return i.value.year&&(E=w.value.filter(o=>o.schoolYear.year===i.value.year)),E.map(o=>({value:o.key,...o}))}),J=$(()=>re.value.map(E=>({value:E.key,...E}))),N=$(()=>{const E={key:null,label:"Nenhum"},o=oe.value.map(R=>({key:R,label:De(R)}));return o.unshift(E),o}),T=$(()=>{const E={key:null,label:"Nenhum"},o=ye.value.map(R=>({key:R.id,label:R.name}));return o.unshift(E),o}),Ee=$(()=>{const E={key:null,label:"Nenhum"},o=Ce.value.map(R=>({key:R,label:je(R)}));return o.unshift(E),o}),Fe=$(()=>ie.value===!1&&y.value.length===0),Le=()=>{var o;const E={...i.value};((o=E.processes)==null?void 0:o.length)===1&&(E.process=E.processes[0]),A(()=>Zt(E)).then(R=>{et(R,"pre-matricula.csv")})},ze=()=>{const E=w.value.find(o=>o.id===i.value.process);ae.value=E.schoolYear.year,ne.value="ACCEPT",B.value=!0},We=()=>{ne.value="REJECT",B.value=!0},Ne=()=>{ne.value="SUMMON",B.value=!0},de=E=>{var pe,c,a,t;ie.value=!0,L.value=!0;const o={...i.value,page:E};((pe=o.processes)==null?void 0:pe.length)===1&&(o.process=o.processes[0]),((c=o.grades)==null?void 0:c.length)===1&&(o.grade=o.grades[0]),Object.keys(o).forEach(b=>{(!o[b]||o[b]==="")&&delete o[b]}),((a=o.processes)==null?void 0:a.length)===0&&delete o.processes,((t=o.grades)==null?void 0:t.length)===0&&delete o.grades,s.auth.user&&s.auth.user.level>=4&&(o.schools=s.auth.user.schools),["period","process","school","grade"].forEach(b=>{let U=o[b];Number(U)||delete o[b]}),le(()=>qt({first:Number(se.value),...o})).then(b=>{if(!b)return;ge.value=b.stats,y.value=b.preregistrations,ee.value=b.paginator,O.value=[];const{process:U,school:ue,grade:me}=i.value;U&&ue&&me&&(i.value.canAcceptInBatch=!0)}).finally(()=>{ie.value=!1})},Ge=E=>{E.target.checked||(H.value=!1),O.value.length===y.value.length&&(H.value=!0)},He=E=>{E.target.checked?O.value=y.value.map(R=>R.id):O.value=[]},qe=()=>{i.value={...f.value},de(1)},Re=()=>{const E={...i.value};Object.assign(E,{...Z.value}),k(()=>Yt(E)).then(o=>{et(o,"pre-matricula.pdf")}).finally(()=>{_e.value=!1})},De=E=>{switch(E){case"REGISTRATION":return"Matr\xEDcula";case"REGISTRATION_RENEWAL":return"Rematr\xEDcula";case"WAITING_LIST":default:return"Lista de espera"}},Ye=E=>{switch(E){case"REGISTRATION":return"badge-blue";case"REGISTRATION_RENEWAL":return"badge-cyan";case"WAITING_LIST":default:return"badge-yellow"}},Pe=E=>{M.push({name:"preregistration.modal",params:{protocol:E}})},Je=()=>{_(()=>Jt({process:i.value.processes[0],school:i.value.school,grade:i.value.grades[0],period:i.value.period})).then(E=>{if(E.nextInLine)Pe(E.nextInLine.protocol);else{I({title:"Aten\xE7\xE3o!",description:"N\xE3o h\xE1 nenhuma inscri\xE7\xE3o em espera.",titleClass:"danger",iconLeft:"status-red"});return}})};(()=>{const E={};s.auth.user&&s.auth.user.level>=4&&(E.schools=s.auth.user.schools),z(()=>Xt(E)).then(o=>{w.value=o.processes.sortBy("name"),te.value=o.schools.sortBy("name"),re.value=o.grades.sortBy("name"),ye.value=o.periods.sortBy("name");const R=[],pe=[];o.processes.forEach(a=>{a.totalPreRegistrations>0?R.push(a.schoolYear.year):pe.push(a.schoolYear.year)}),R.sort().reverse();const c=R[0];S.value=R.concat(pe).filter((a,t,b)=>b.indexOf(a)===t).map(a=>({key:a,label:a})).sortBy("key").reverse(),c&&(i.value.year=c),te.value.length===1&&(i.value.school=te.value[0].id),de(1)})})(),Se(q,E=>{E.name!=="preregistration.modal"&&de(E.query.page||1)},{deep:!0}),Se(se,()=>{ee.value&&de(ee.value.currentPage)},{deep:!0});const Ze={toExport:Le};return(E,o)=>{const R=Ct("router-view"),pe=kt("tooltip");return n(),d("main",null,[o[42]||(o[42]=e("h1",null,"Pr\xE9-matr\xEDculas",-1)),v(Rt,{stats:ge.value},null,8,["stats"]),v(Et,{class:"bg-primary mb-5"},{default:j(()=>[v(It,{class:"pl-2 pr-2"},{default:j(()=>{var c,a;return[e("form",{onSubmit:o[13]||(o[13]=vt(t=>de(1),["prevent"]))},[e("div",No,[v(K,{modelValue:i.value.search,"onUpdate:modelValue":o[0]||(o[0]=t=>i.value.search=t),"container-class":"col-12 col-md-4 mb-2 mb-md-0",name:"search",placeholder:"Nome do(a) aluno(a)",type:"TEXT"},null,8,["modelValue"]),v(K,{modelValue:i.value.year,"onUpdate:modelValue":o[1]||(o[1]=t=>i.value.year=t),"container-class":"col-12 col-md-2 mb-2 mb-md-0",name:"year",placeholder:"Filtrar ano",type:"SELECT",options:S.value},null,8,["modelValue","options"]),e("div",Ro,[v(it,{modelValue:i.value.processes,"onUpdate:modelValue":o[2]||(o[2]=t=>i.value.processes=t),options:be.value,placeholder:"Filtrar por processo",onChange:o[3]||(o[3]=t=>i.value.canAcceptInBatch=!1)},null,8,["modelValue","options"])]),v(K,{modelValue:i.value.type,"onUpdate:modelValue":o[4]||(o[4]=t=>i.value.type=t),"container-class":"col-12 col-md-3 mb-2 mb-md-0",name:"type",placeholder:"Filtrar por tipo",type:"SELECT",options:N.value},null,8,["modelValue","options"])]),e("div",Io,[v(K,{modelValue:i.value.school,"onUpdate:modelValue":o[5]||(o[5]=t=>i.value.school=t),"container-class":"col-12 col-md-3 mb-2 mb-md-0",name:"school",placeholder:"Filtrar por escola",type:"SELECT",options:te.value,searchable:"",onChange:o[6]||(o[6]=t=>i.value.canAcceptInBatch=!1)},null,8,["modelValue","options"]),e("div",zo,[v(it,{modelValue:i.value.grades,"onUpdate:modelValue":o[7]||(o[7]=t=>i.value.grades=t),"container-class":"col-12 col-md-3 mb-2 mb-md-0",options:J.value,placeholder:"Filtrar por s\xE9rie",onChange:o[8]||(o[8]=t=>i.value.canAcceptInBatch=!1)},null,8,["modelValue","options"])]),v(K,{modelValue:i.value.period,"onUpdate:modelValue":o[9]||(o[9]=t=>i.value.period=t),"container-class":"col-12 col-md-3 mb-2 mb-md-0",name:"period",placeholder:"Filtrar por turno",type:"SELECT",options:T.value},null,8,["modelValue","options"]),v(K,{modelValue:i.value.status,"onUpdate:modelValue":o[10]||(o[10]=t=>i.value.status=t),"container-class":"col-12 col-md-3 mb-2 mb-md-0",name:"status",placeholder:"Filtrar por status",type:"SELECT",options:Ee.value},null,8,["modelValue","options"])]),e("div",Do,[e("div",Po,[v(V,{label:"Emitir relat\xF3rio",color:"white",outline:"",class:"ml-2","no-caps":"","no-wrap":"",icon:"mdi-note-text-outline","loading-normal":"",onClick:o[11]||(o[11]=t=>_e.value=!0)}),((c=i.value.processes)==null?void 0:c.length)===1&&i.value.school&&((a=i.value.grades)==null?void 0:a.length)===1&&i.value.period&&i.value.status==="WAITING"?(n(),F(V,{key:0,label:"Convocar pr\xF3xima inscri\xE7\xE3o",color:"white",outline:"",class:"ml-2","no-caps":"","no-wrap":"","loading-normal":"",loading:l(P),onClick:Je},null,8,["loading"])):m("",!0)]),e("div",Mo,[v(V,{"data-test":"cleanFilter",label:"Limpar",color:"white",flat:"",class:"mr-3","no-caps":"","no-wrap":"",onClick:qe}),v(V,{"data-test":"btn-search-pre-registration",label:"Buscar",color:"white",outline:"",class:"mr-2","no-caps":"","no-wrap":"",loading:ie.value,"loading-normal":"",onClick:o[12]||(o[12]=t=>de(1))},null,8,["loading"])])])],32)]}),_:1})]),_:1}),e("div",Oo,[e("div",Uo,[v(dt,{modelValue:i.value.sort,"onUpdate:modelValue":o[14]||(o[14]=c=>i.value.sort=c),options:l(zt)(),class:"custom-select",onChange:o[15]||(o[15]=c=>de(1))},{option:j(()=>o[28]||(o[28]=[e("option",{value:null},"Ordenar por:",-1)])),_:1},8,["modelValue","options"])]),e("div",jo,[v(V,{"data-test":"summon",label:"Convocar respons\xE1veis",disable:Y.value,color:"summon",outline:"",class:"ml-0 ml-lg-3 mb-2 mb-lg-0 pmd-custom",icon:"pmd-summon","no-caps":"","no-wrap":"",onClick:Ne},null,8,["disable"]),v(V,{"data-test":"reject",label:"Indeferir pr\xE9-matr\xEDcula",disable:x.value,color:"rejected",outline:"",class:"ml-0 ml-lg-3 mb-2 mb-lg-0 pmd-custom",icon:"pmd-rejected","no-caps":"","no-wrap":"",onClick:We},null,8,["disable"]),v(V,{"data-test":"accept",label:"Deferir pr\xE9-matr\xEDcula",disable:r.value,color:"accepted",outline:"",class:"ml-0 ml-lg-3 mb-2 mb-lg-0 pmd-custom",icon:"pmd-accepted","no-caps":"","no-wrap":"",onClick:ze},null,8,["disable"])])]),e("div",Bo,[o[29]||(o[29]=e("div",{class:"mr-2"},"Mostrar",-1)),e("div",Fo,[v(dt,{modelValue:se.value,"onUpdate:modelValue":o[16]||(o[16]=c=>se.value=c),options:Te.value,class:"form-control form-control-sm"},null,8,["modelValue","options"])]),o[30]||(o[30]=e("div",null,"registros por p\xE1gina",-1))]),ie.value?(n(),F(Mt,{key:0})):(n(),d("table",Lo,[e("thead",null,[e("tr",null,[e("th",Wo,[e("div",Go,[fe(e("input",{id:"allChecked","onUpdate:modelValue":o[17]||(o[17]=c=>H.value=c),type:"checkbox",class:"custom-control-input",onChange:He},null,544),[[Qe,H.value]]),o[31]||(o[31]=e("label",{class:"custom-control-label",for:"allChecked"},[e("span",{class:"d-none"},"Marcar todos")],-1))])]),o[32]||(o[32]=e("th",null,"Status",-1)),o[33]||(o[33]=e("th",null,"Protocolo",-1)),o[34]||(o[34]=e("th",null,"Nome do(a) aluno(a)",-1)),o[35]||(o[35]=e("th",null,"Escola",-1)),o[36]||(o[36]=e("th",null,"Posi\xE7\xE3o",-1)),o[37]||(o[37]=e("th",null,"S\xE9rie",-1)),o[38]||(o[38]=e("th",null,"Turno",-1)),o[39]||(o[39]=e("th",null,"Tipo",-1))])]),e("tbody",null,[Fe.value?(n(),d("tr",Ho,o[40]||(o[40]=[e("td",{colspan:"9"},"Nenhum resultado.",-1)]))):(n(!0),d(we,{key:1},ke(y.value,c=>(n(),d("tr",{key:c.id},[e("td",qo,[e("div",Yo,[fe(e("input",{id:`checkbox-${c.id}`,"onUpdate:modelValue":o[18]||(o[18]=a=>O.value=a),value:c.id,type:"checkbox",class:"custom-control-input",onChange:Ge},null,40,Jo),[[Qe,O.value]]),e("label",{for:`checkbox-${c.id}`,class:"custom-control-label"},o[41]||(o[41]=[e("span",{class:"d-none"},"Marcar pr\xE9-matr\xEDcula",-1)]),8,Xo)])]),e("td",null,[fe(e("span",{class:ce(l(Oe)(c.status))},null,2),[[pe,l(je)(c.status),void 0,{"bottom-start":!0}]])]),e("td",null,[e("a",{"data-test":"protocol",href:"javascript:void(0)",onClick:a=>Pe(c.protocol)}," #"+u(c.protocol),9,Zo)]),e("td",null,u(c.student.name),1),e("td",null,[he(u(c.school.name)+" ",1),c.waiting?(n(),d("div",Ko,[e("small",Qo,u(c.waiting.school.name),1),e("span",{class:ce(l(Oe)(c.waiting.status))},null,2)])):m("",!0),c.parent?(n(),d("div",es,[e("small",ts,u(c.parent.school.name),1),e("span",{class:ce(l(Oe)(c.parent.status))},null,2)])):m("",!0)]),e("td",null,[he(u(c.position)+"\xBA ",1),c.waiting?(n(),d("div",os,[e("small",ss,u(c.waiting.position)+"\xBA ",1)])):m("",!0),c.parent?(n(),d("div",ls,[e("small",as,u(c.parent.position)+"\xBA ",1)])):m("",!0)]),e("td",null,u(c.grade?c.grade.name:"-"),1),e("td",null,u(c.period?c.period.name:"-"),1),e("td",null,[e("span",{class:ce([Ye(c.type),"badge"])},u(De(c.type)),3)])]))),128))])])),v(Dt,{"paginator-info":ee.value,onPage:o[19]||(o[19]=c=>de(c))},null,8,["paginator-info"]),ee.value&&ee.value.total?(n(),d("div",ns,[e("div",rs,[v(V,{"data-test":"toExport",label:"Exportar",loading:l(C),class:"w-100",color:"primary","no-caps":"","no-wrap":"","loading-normal":"",onClick:o[20]||(o[20]=c=>Ze.toExport())},null,8,["loading"])])])):m("",!0),B.value?(n(),F(Ao,{key:3,modelValue:B.value,"onUpdate:modelValue":o[21]||(o[21]=c=>B.value=c),filter:i.value,preregistrations:O.value,"process-year":ae.value,step:ne.value,onLoad:de},null,8,["modelValue","filter","preregistrations","process-year","step"])):m("",!0),v(Be,{ref_key:"fieldsModal",ref:W,modelValue:_e.value,"onUpdate:modelValue":o[27]||(o[27]=c=>_e.value=c),"no-footer":"",title:"Emitir Relat\xF3rio","is-overflow-visible":""},{body:j(()=>[e("div",is,[v(K,{id:"reportModel",modelValue:Z.value.template,"onUpdate:modelValue":o[22]||(o[22]=c=>Z.value.template=c),label:"Modelo",rules:"required",name:"reportModel",type:"SELECT","allow-clear":!1,searchable:!1,options:l(Pt)(),placeholder:"Selecione o modelo","container-class":"col-12 form-group","onOpen:options":o[23]||(o[23]=c=>W.value.setOverflowVisible(!0)),"onClose:options":o[24]||(o[24]=c=>W.value.setOverflowVisible(!1))},null,8,["modelValue","options"]),v(K,{modelValue:Z.value.showStudentShortName,"onUpdate:modelValue":o[25]||(o[25]=c=>Z.value.showStudentShortName=c),name:"showStudentShortName","container-class":"col-12 form-group",label:"Exibir apenas iniciais do nome do candidato?",type:"CHECKBOX"},null,8,["modelValue"]),(Z.value.template===3||Z.value.template===4)&&i.value.status==="WAITING"?fe((n(),F(K,{key:0,modelValue:Z.value.disregardStudentsIeducar,"onUpdate:modelValue":o[26]||(o[26]=c=>Z.value.disregardStudentsIeducar=c),name:"disregardStudentsIeducar","container-class":"col-12 form-group",label:"Desconsiderar alunos com matr\xEDcula ativa no i-Educar?",type:"CHECKBOX"},null,8,["modelValue"])),[[pe,"Marque esta op\xE7\xE3o se, al\xE9m de o relat\xF3rio considerar apenas os alunos com situa\xE7\xE3o 'Em espera', tamb\xE9m seja necess\xE1ria uma valida\xE7\xE3o no i-Educar para tamb\xE9m desconsiderar alunos com matricula ativa no ano do processo",void 0,{"start-bottom":!0}]]):m("",!0)])]),footer:j(()=>[e("div",ds,[e("div",us,[v(V,{"data-test":"toReport",loading:l(D),color:"primary",class:"w-100",label:"Emitir relat\xF3rio","no-caps":"","no-wrap":"",onClick:Re},null,8,["loading"])])])]),_:1},8,["modelValue"]),v(R,null,{default:j(({Component:c})=>[(n(),F(St(c),{key:l(G).path}))]),_:1})])}}}),Ua=Object.freeze(Object.defineProperty({__proto__:null,default:cs},Symbol.toStringTag,{value:"Module"})),ps={key:0,class:"d-flex border-top"},ms={class:"col-4 py-2 mb-0"},vs={class:"font-hind font-size-10"},fs={class:"mb-0",style:{"min-height":"24px"}},gs={class:"col-4 py-2 mb-0 bg-white"},bs={class:"font-hind font-size-10"},Es={class:"mb-0",style:{"min-height":"24px"}},xs={class:"col-4 py-2 mb-0 d-flex align-items-center"},hs={key:0,class:"custom-control custom-checkbox"},ys=["id","value"],_s=["for"],ve=Ae({__name:"ExternalSystemSync",props:{modelValue:{type:Boolean},alwaysShow:{type:Boolean},external:{},internal:{},label:{},legend:{}},emits:["update:modelValue"],setup($e){const I=$e,le=$(()=>I.external!==I.internal&&!!I.internal),z=$(()=>I.alwaysShow?!0:I.internal?le.value:!1),_=Math.random().toString(36);return(P,A)=>z.value?(n(),d("div",ps,[e("dl",ms,[e("dt",vs,u(P.label),1),e("dd",fs,u(P.external),1)]),e("dl",gs,[e("dt",bs,u(P.label),1),e("dd",Es,u(P.internal),1)]),e("div",xs,[le.value?(n(),d("div",hs,[e("input",{id:l(_),value:P.modelValue,type:"checkbox",class:"custom-control-input",onInput:A[0]||(A[0]=C=>P.$emit("update:modelValue",C.target.checked))},null,40,ys),e("label",{for:l(_),class:"custom-control-label font-size-10"},u(P.legend),9,_s)])):m("",!0)])])):m("",!0)}}),ws={class:"timeline-blocks"},$s={class:"block-header"},Cs=["innerHTML"],ks={key:0,class:"block-date"},Ss={key:0,class:"block-changes"},Ts={class:"block-diff-list"},Vs={class:"diff-field"},As={class:"diff-content"},Ns={class:"diff-text-row"},Rs=["title"],Is={key:0},zs={key:1,class:"text-muted"},Ds=["onClick"],Ps={class:"diff-content"},Ms={class:"diff-text-row"},Os=["title"],Us={key:0},js={key:1,class:"text-muted"},Bs=["onClick"],Fs={key:1,class:"timeline-empty"},Ls=Ae({__name:"Timeline",props:{items:{}},setup($e){const I=p({}),le=(A,C)=>{var k;const h=`<span class='user-name'>${((k=C==null?void 0:C.user)==null?void 0:k.name)||"Sistema"}</span>`;switch(A){case"student-responsible-address-updated":return`<strong>${h}</strong> atualizou o <strong>endere\xE7o</strong> do respons\xE1vel`;case"preregistration-external-system-address-updated":return`<strong>${h}</strong> atualizou o <strong>endere\xE7o</strong> no i-Educar`;case"preregistration-external-system-phones-updated":return`<strong>${h}</strong> atualizou os <strong>telefones</strong> no i-Educar`;case"preregistration-external-system-individual-updated":return`<strong>${h}</strong> atualizou o <strong>aluno</strong> no i-Educar`;case"preregistration-external-system-documents-updated":return`<strong>${h}</strong> atualizou os <strong>documentos</strong> no i-Educar`;case"preregistration-external-system-name-updated":return`<strong>${h}</strong> atualizou o <strong>nome</strong> no i-Educar`;case"preregistration-updated":return`<strong>${h}</strong> atualizou a <strong>pr\xE9-matr\xEDcula</strong>`;case"preregistration-student-responsible-updated":return`<strong>${h}</strong> atualizou o <strong>respons\xE1vel</strong>`;case"preregistration-status-updated":return`<strong>${h}</strong> atualizou o <strong>status</strong> da pr\xE9-matricula`;case"preregistration-student-updated":return`<strong>${h}</strong> atualizou os dados do <strong>aluno</strong>`;case"preregistration-status-auto-rejected":return"Foi atualizado o <strong>status</strong> da pr\xE9-matricula atrav\xE9s do indeferimento autom\xE1tico";default:return""}},z=A=>A?A.length>50:!1,_=A=>{I.value[A]=!I.value[A]};function P(A){if(!A)return"";const C=new Date(A),h=String(C.getDate()).padStart(2,"0"),k=String(C.getMonth()+1).padStart(2,"0"),D=C.getFullYear(),s=String(C.getHours()).padStart(2,"0"),M=String(C.getMinutes()).padStart(2,"0");return`${h}/${k}/${D} ${s}:${M}`}return(A,C)=>(n(),d("div",null,[C[1]||(C[1]=e("h2",{class:"timeline-title"},"Hist\xF3rico de Atualiza\xE7\xF5es",-1)),e("div",ws,[A.items.length?(n(!0),d(we,{key:0},ke(A.items,(h,k)=>(n(),d("div",{key:k,class:"timeline-block altered"},[e("div",$s,[e("div",{class:"block-title",innerHTML:le(h.type,h.payload)},null,8,Cs),h.createdAt?(n(),d("div",ks,u(P(h.createdAt)),1)):m("",!0)]),h.payload.before&&h.payload.after?(n(),d("div",Ss,[e("ul",Ts,[(n(!0),d(we,null,ke(h.payload.before,(D,s)=>(n(),d("li",{key:s},[e("span",Vs,u(s)+":",1),e("div",As,[e("div",Ns,[e("div",{class:ce(["diff-text",{"is-expanded":I.value[`${k}-${s}`]}]),title:z(D)?D:""},[D!=null&&D!==""?(n(),d("span",Is,u(D),1)):(n(),d("span",zs,"Vazio"))],10,Rs),z(D)?(n(),d("button",{key:0,class:"expand-button",onClick:M=>_(`${k}-${s}`)},[e("i",{class:ce(["expand-icon",{"is-expanded":I.value[`${k}-${s}`]}])},"\u25BC",2)],8,Ds)):m("",!0)])]),C[0]||(C[0]=e("span",{class:"diff-arrow"},"\u2192",-1)),e("div",Ps,[e("div",Ms,[e("div",{class:ce(["diff-text diff-text-after",{"is-expanded":I.value[`${k}-${s}-after`]}]),title:z(h.payload.after[s])?h.payload.after[s]:""},[h.payload.after[s]!==null&&h.payload.after[s]!==void 0&&h.payload.after[s]!==""?(n(),d("span",Us,u(h.payload.after[s]),1)):(n(),d("span",js,"Vazio"))],10,Os),z(h.payload.after[s])?(n(),d("button",{key:0,class:"expand-button",onClick:M=>_(`${k}-${s}-after`)},[e("i",{class:ce(["expand-icon",{"is-expanded":I.value[`${k}-${s}-after`]}])},"\u25BC",2)],8,Bs)):m("",!0)])])]))),128))])])):m("",!0)]))),128)):(n(),d("div",Fs,"Nenhum hist\xF3rico encontrado."))])]))}});const Ws=ft(Ls,[["__scopeId","data-v-ec4fd359"]]),Gs={class:"m-auto",style:{"max-width":"740px"}},Hs={key:0,class:"mt-4 text-danger font-weight-bold"},qs={key:1,class:"mt-4 font-weight-bold"},Ys={key:2,class:"mt-4 font-weight-bold"},Js={key:3,class:"mt-4 font-weight-bold"},Xs={key:4},Zs={class:"row mt-4"},Ks={class:"col-6"},Qs={key:5},el={class:"row mt-4"},tl={class:"col-12"},ol={key:6},sl={class:"row mt-4"},ll={class:"col-6"},al={key:0,class:"col-6"},nl={key:7,class:"row mt-5 mb-4 rounded",style:{background:"#f3f8ff"}},rl={class:"col-12"},il={key:8,class:"row mt-4"},dl={class:"col-6"},ul={class:"col-6"},cl={class:"col-6"},pl={class:"col-6"},ml={class:"col-12"},vl={class:"col-12"},fl={class:"col-6"},gl={key:0,class:"col-6"},bl={key:9,class:"row mb-5"},El={class:"col-12"},xl={class:"custom-control custom-checkbox"},hl={key:10,class:"row"},yl={key:0,class:"col-12 mb-3"},_l={class:"alert badge-yellow"},wl={class:"row mt-3"},$l={class:"col-2 mb-0"},Cl={class:"col-2 mb-0"},kl={class:"col-8 mb-0"},Sl={key:1,class:"col-12 mb-3"},Tl={class:"alert badge-blue"},Vl={class:"row mt-3"},Al={class:"col-2 mb-0"},Nl={class:"col-2 mb-0"},Rl={class:"col-8 mb-0"},Il={key:2,class:"col-12 mb-3"},zl={class:"alert badge-blue"},Dl={class:"col-2 mb-0"},Pl=["onClick"],Ml={class:"col-2 mb-0"},Ol={class:"col-5 mb-0"},Ul={class:"col-2 mb-0"},jl={class:"font-hind font-size-10"},Bl={class:"row"},Fl={class:"col-6"},Ll={class:"row"},Wl={class:"font-hind font-size-10"},Gl={class:"col-6"},Hl={class:"col-6"},ql={key:0,class:"col-6"},Yl={class:"col-6"},Jl={class:"col-6"},Xl={class:"col-6"},Zl={key:12,class:"form-group"},Kl={key:13,class:"form-group"},Ql={key:14,class:"mt-4 font-weight-bold"},ea={class:"row"},ta={key:15},oa={class:"text-danger"},sa=["innerHTML"],la={key:0,class:"d-flex flex-column flex-lg-row justify-content-center"},aa={key:1,class:"d-flex flex-column flex-lg-row justify-content-center"},na={inheritAttrs:!1},ra=Ae({...na,__name:"PreRegistrationModal",setup($e){var c;const I=gt("$filters"),{loader:le,loading:z}=Ve(),{loader:_,loading:P}=Q(),{loader:A,loading:C}=Q(),{loader:h,data:k}=Q([]),{loader:D,data:s}=Q({}),{loader:M,loading:G}=Ve(),{loader:q,loading:L}=Ve(),W=(c=mt())==null?void 0:c.appContext,{loader:ae}=bt(W,p({title:"Aten\xE7\xE3o!",description:"N\xE3o foi poss\xEDvel emitir o relat\xF3rio. Tente novamente."})),B=lt(),ne=st(),H=ot(),O=p({responsible:[],student:[]}),ge=p({}),ee=p({}),y=p("SHOW"),f=p(""),i=p(),w=p(!1),te=p(),re=p(),ye=p(!0),oe=p(!1),Ce=p(!1),S=p({cpf:!1,rg:!1,birthCertificate:!1,name:!1,dateOfBirth:!1,gender:!1,phone:!1,mobile:!1,email:!1,address:!1}),se=p(!1),Te=p(""),ie=p(),_e=$(()=>B.isAdmin),Z=$(()=>B.isCoordinator),x=$(()=>B.isSecretary),r=$(()=>{const a=s.value.external,t=s.value.student,b=s.value.responsible;return a?(a==null?void 0:a.cpf)!==t.student_cpf&&!!t.student_cpf||(a==null?void 0:a.rg)!==t.student_rg&&!!t.student_rg||(a==null?void 0:a.birthCertificate)!==t.student_birth_certificate&&!!t.student_birth_certificate||(a==null?void 0:a.gender)!==t.student_gender&&!!t.student_gender||(a==null?void 0:a.phone)!==t.student_phone&&!!t.student_phone||(a==null?void 0:a.phone)!==b.responsible_phone&&!!b.responsible_phone||(a==null?void 0:a.mobile)!==t.student_mobile&&!!t.student_mobile||(a==null?void 0:a.mobile)!==b.responsible_mobile&&!!b.responsible_mobile||(a==null?void 0:a.email)!==t.student_email&&!!t.student_email||(a==null?void 0:a.email)!==b.responsible_email&&!!b.responsible_email||(a==null?void 0:a.name)!==t.student_name&&!!t.student_name||(a==null?void 0:a.dateOfBirth)!==t.student_date_of_birth&&!!t.student_date_of_birth:!1}),Y=$(()=>{let a=s.value.responsible.responsible_address[0],t=`${a.address}, ${a.number}`;return a.complement&&(t=`${t}, ${a.complement}`),t=`${t}, ${a.neighborhood}, ${a.postalCode}`,t}),be=$(()=>{var t,b,U,ue,me,X,xe;if(!((t=s.value.external)!=null&&t.address))return;let a=`${(b=s.value.external)==null?void 0:b.address}, ${(U=s.value.external)==null?void 0:U.number}`;return(ue=s.value.external)!=null&&ue.complement&&(a=`${a}, ${(me=s.value.external)==null?void 0:me.complement}`),a=`${a}, ${(X=s.value.external)==null?void 0:X.neighborhood}, ${(xe=s.value.external)==null?void 0:xe.postalCode}`,a}),J=$(()=>Object.keys(s.value).length===0),N=$(()=>(y.value==="SHOW"||y.value==="ACCEPT")&&s.value.status!=="ACCEPTED"),T=$(()=>(_e.value||Z.value||x.value)&&s.value.status!=="WAITING"&&y.value==="SHOW"),Ee=$(()=>(y.value==="SHOW"||y.value==="REJECT")&&(s.value.status==="WAITING"||s.value.status==="SUMMONED")),Fe=$(()=>(y.value==="SHOW"||y.value==="SUMMON")&&s.value.status==="WAITING"),Le=$(()=>r.value&&["WAITING","ACCEPTED"].includes(s.value.status)&&B.features.allowExternalSystemDataUpdate),ze=(a,t)=>t==="STUDENT"?a.filter(ee.value[a.key]):a.filter(ge.value[a.key]),We=()=>{w.value=!1,q(()=>Kt({preregistration:s.value.id,...S.value})).then(a=>{if(!a){w.value=!0,te.value="Erro",re.value="N\xE3o foi poss\xEDvel atualizar as informa\xE7\xF5es no i-Educar";return}Ce.value=!0,s.value.status==="ACCEPTED"?y.value="SHOW":Ne()}).catch(a=>{var t;w.value=!0,te.value=a.response.data.errors[0].message,re.value=(t=a.response.data.errors[0].extensions)==null?void 0:t.message})},Ne=()=>{if(w.value=!1,y.value==="SHOW"&&r.value)y.value="SYNC";else if(["SYNC","SHOW"].includes(y.value))y.value="ACCEPT",qe();else if(y.value==="ACCEPT"){if(!Number(i.value)){w.value=!0,te.value="\xC9 necess\xE1rio selecionar uma turma para realizar o Deferimento da pr\xE9-matr\xEDcula.",re.value="";return}le(()=>Qt({ids:[s.value.id].map(a=>Number(a)),classroom:Number(i.value)})).then(()=>{H.push({name:"preregistrations"})}).catch(a=>{var t;w.value=!0,te.value=a.response.data.errors[0].message,re.value=(t=a.response.data.errors[0].extensions)==null?void 0:t.message})}},de=()=>{y.value==="SHOW"?(f.value="",y.value="REJECT"):y.value==="REJECT"&&_(()=>eo({ids:[s.value.id],justification:f.value})).then(()=>{H.push({name:"preregistrations"})})},Ge=()=>{A(()=>to({ids:[s.value.id]})).then(()=>{H.push({name:"preregistrations"})})},He=()=>{y.value="SYNC"},qe=()=>{h(()=>yt({period:s.value.period.id,school:s.value.school.id,grade:s.value.grade.id,year:s.value.process.schoolYear.year}))},Re=a=>{H.push({name:"preregistration.modal",params:{protocol:a}})},De=()=>{H.push({name:"preregistration.edit.modal",params:{protocol:ne.params.protocol}})},Ye=a=>{switch(a){case"REGISTRATION":return"Matr\xEDcula";case"REGISTRATION_RENEWAL":return"Rematr\xEDcula";case"WAITING_LIST":default:return"Lista de espera"}},Pe=a=>{switch(a){case"REGISTRATION":return"badge-blue";case"REGISTRATION_RENEWAL":return"badge-cyan";case"WAITING_LIST":default:return"badge-yellow"}},Je=a=>{var t;return(t=B.relationTypes.find(b=>b.key===a))==null?void 0:t.label},Xe=a=>{!a||(s.value={},D(()=>_t({protocol:a})).then(t=>{const{fields:b,data:U}=xt(t.process),{fields:ue,data:me}=ht(t.process);t.fields.filter(X=>X.field.group==="RESPONSIBLE").forEach(X=>{const xe=`field_${X.field.id}`;U[xe]=X.value}),t.fields.filter(X=>X.field.group==="STUDENT").forEach(X=>{const xe=`field_${X.field.id}`;me[xe]=X.value}),O.value.responsible=b.sortBy("order"),ge.value={...U,...t.responsible,responsible_place_of_birth:t.responsible.responsible_city_of_birth||t.responsible.responsible_place_of_birth},O.value.student=ue.sortBy("order"),ee.value={...me,...t.student,student_place_of_birth:t.student.student_city_of_birth||t.student.student_place_of_birth}}))},Ze=()=>{y.value==="SHOW"?(f.value="",y.value="SUMMON"):M(()=>oo({ids:[s.value.id],justification:f.value})).then(()=>{H.push({name:"preregistrations"})}).catch(a=>{w.value=!0,te.value="N\xE3o foi poss\xEDvel realizar a convoca\xE7\xE3o de todos os(as) respons\xE1veis(as)",re.value=a.response.data.errors.map(t=>{var b;return(b=t.extensions)==null?void 0:b.message}).join("<br>")})},Ie=$(()=>ne);Se(Ie,a=>{Xe(a.params.protocol)},{deep:!0}),Se(ye,a=>{a||H.push({name:"preregistrations"})});const E=async()=>{var a;if(se.value=!se.value,se.value){await At();const t=((a=ie.value)==null?void 0:a.$el)||ie.value;if(t){const b=t.getBoundingClientRect(),U=window.innerWidth-(b.left+b.width),ue=b.top-4;Te.value=`bottom: ${window.innerHeight-ue}px; left: auto; right: ${U}px; min-width: 150px; max-width: 200px;`}}},o=a=>{se.value=!1,a()},R=p([]);Se(()=>s.value.id,async a=>{if(a)try{const b=(await lo(String(a),"iEducar\\Packages\\PreMatricula\\Models\\PreRegistration")).listTimeline.map(U=>({...U,payload:typeof U.payload=="string"?JSON.parse(U.payload):U.payload}));R.value=b}catch{R.value=[]}},{immediate:!0});const pe=()=>{const a={template:"5",protocol:s.value.protocol};ae(()=>so(a)).then(t=>{et(t,"atestado-vaga.pdf")})};return tt(()=>{Xe(Ie.value.params.protocol),document.addEventListener("click",()=>{se.value=!1}),setTimeout(()=>{const a=document.querySelector(".x-card, .modal, .x-modal__inner");a&&(a.style.overflow="visible")},100)}),(a,t)=>(n(),F(Be,{modelValue:ye.value,"onUpdate:modelValue":t[21]||(t[21]=b=>ye.value=b),"title-class":"font-hind-18-primary text-uppercase text-primary",title:J.value?"":l(s).student.student_name,"icon-right":l(Oe)(J.value?"":l(s).status),"tooltip-icon":l(je)(J.value?"":l(s).status),"initial-loading":J.value,large:!0,"loading-text":"",persistent:J.value,onCloseModal:t[22]||(t[22]=b=>a.$router.push({name:"preregistrations"}))},{body:j(()=>{var b,U,ue,me,X,xe,at,nt,rt;return[e("div",Gs,[y.value==="REJECT"?(n(),d("div",Hs,t[23]||(t[23]=[he(" Tem certeza que deseja indeferir a inscri\xE7\xE3o? "),e("hr",null,null,-1)]))):m("",!0),y.value==="SYNC"?(n(),d("div",qs,t[24]||(t[24]=[he(" Encontramos diferen\xE7as entre as informa\xE7\xF5es fornecidas na inscri\xE7\xE3o e as j\xE1 registradas no "),e("span",{style:{"white-space":"nowrap"}},"i-Educar",-1),he(". Por favor, selecione quais informa\xE7\xF5es voc\xEA gostaria de atualizar no i-Educar. ")]))):m("",!0),["ACCEPT","SHOW"].includes(y.value)&&Ce.value?(n(),d("div",Ys,t[25]||(t[25]=[e("div",{class:"alert alert-success"},[e("svg",{width:"22",height:"22",viewBox:"0 0 22 22",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("rect",{width:"21.5579",height:"21.5579",rx:"10.7789",fill:"#CCFAB6"}),e("path",{d:"M11 0C4.93457 0 0 4.93457 0 11C0 17.0654 4.93457 22 11 22C17.0654 22 22 17.0654 22 11C22 4.93457 17.0654 0 11 0ZM11 19.3171C6.41394 19.3171 2.68293 15.5861 2.68293 11C2.68293 6.41394 6.41394 2.68293 11 2.68293C15.5861 2.68293 19.3171 6.41394 19.3171 11C19.3171 15.5861 15.5861 19.3171 11 19.3171Z",fill:"#298000"}),e("path",{d:"M11 6.85883C12.4228 6.85883 13.6787 7.57642 14.4245 8.67059H13.0705V9.70589H16.1764V6.6H15.1411V7.89379C14.197 6.6371 12.6939 5.82353 11 5.82353C8.14107 5.82353 5.82349 8.14112 5.82349 11H6.85878C6.85878 8.71289 8.71285 6.85883 11 6.85883ZM15.1411 11C15.1411 13.2871 13.2871 15.1412 11 15.1412C9.57717 15.1412 8.32117 14.4236 7.57543 13.3294H8.92937V12.2941H5.82349V15.4H6.85878V14.1062C7.80287 15.3629 9.30603 16.1765 11 16.1765C13.8588 16.1765 16.1764 13.8589 16.1764 11H15.1411Z",fill:"#298000"})]),e("span",{class:"ml-3"}," Informa\xE7\xF5es de cadastro atualizadas no i-Educar! ")],-1)]))):m("",!0),y.value==="ACCEPT"?(n(),d("div",Js,t[26]||(t[26]=[he(" Selecione a turma que deseja matricular o(a) aluno(a) para completar o deferimento da pr\xE9-matr\xEDcula do(a) aluno(a). "),e("hr",null,null,-1)]))):m("",!0),l(s).status==="REJECTED"?(n(),d("div",Xs,[t[28]||(t[28]=e("div",{class:"mt-4 text-danger font-weight-bold"},"Indeferido",-1)),e("div",Zs,[e("dl",Ks,[t[27]||(t[27]=e("dt",{class:"font-hind font-size-10"}," Justificativa do indeferimento ",-1)),e("dd",null,u(l(s).observation),1)])]),t[29]||(t[29]=e("hr",null,null,-1))])):m("",!0),l(s).status==="SUMMONED"&&l(s).observation?(n(),d("div",Qs,[t[31]||(t[31]=e("div",{class:"mt-4 font-weight-bold",style:{color:"#1900b4"}}," Em convoca\xE7\xE3o ",-1)),e("div",el,[e("dl",tl,[t[30]||(t[30]=e("dt",{class:"font-hind font-size-10"},"Observa\xE7\xF5es",-1)),e("dd",null,u(l(s).observation),1)])]),t[32]||(t[32]=e("hr",null,null,-1))])):m("",!0),l(s).status==="ACCEPTED"?(n(),d("div",ol,[t[35]||(t[35]=e("div",{class:"mt-4 text-success font-weight-bold"},"Deferido",-1)),e("div",sl,[e("dl",ll,[t[33]||(t[33]=e("dt",{class:"font-hind font-size-10"},"Escola",-1)),e("dd",null,u(l(s).school.name),1)]),l(s).classroom?(n(),d("dl",al,[t[34]||(t[34]=e("dt",{class:"font-hind font-size-10"},"Turma",-1)),e("dd",null,u(l(s).classroom.name),1)])):m("",!0)]),t[36]||(t[36]=e("hr",null,null,-1))])):m("",!0),y.value==="SYNC"?(n(),d("div",nl,[e("div",rl,[t[37]||(t[37]=e("div",{class:"d-flex"},[e("div",{class:"font-hind text-primary font-weight-bold col-4 p-3"}," Registro no i-Educar "),e("div",{class:"font-hind text-primary font-weight-bold col-4 p-3 bg-white"}," Informa\xE7\xF5es fornecidas na inscri\xE7\xE3o "),e("div",{class:"font-hind text-primary font-weight-bold col-4 p-3"}," Selecione os itens que deseja atualizar ")],-1)),t[38]||(t[38]=e("div",{class:"d-flex"},[e("div",{class:"font-hind font-weight-bold col-4 p-3 pt-0"}," Dados do(a) aluno(a) "),e("div",{class:"font-hind font-weight-bold col-4 p-3 bg-white"}),e("div",{class:"font-hind font-weight-bold col-4 p-3"})],-1)),v(ve,{modelValue:S.value.name,"onUpdate:modelValue":t[0]||(t[0]=g=>S.value.name=g),external:(b=l(s).external)==null?void 0:b.name,internal:l(s).student.student_name,"always-show":"",label:"Nome",legend:"Atualizar Nome"},null,8,["modelValue","external","internal"]),v(ve,{modelValue:S.value.dateOfBirth,"onUpdate:modelValue":t[1]||(t[1]=g=>S.value.dateOfBirth=g),external:(U=l(s).external)!=null&&U.dateOfBirth?l(ut)(l(s).external.dateOfBirth):"",internal:l(s).student.student_date_of_birth?l(ut)(l(s).student.student_date_of_birth):"","always-show":"",label:"Data de nascimento",legend:"Atualizar data de nascimento"},null,8,["modelValue","external","internal"]),v(ve,{modelValue:S.value.gender,"onUpdate:modelValue":t[2]||(t[2]=g=>S.value.gender=g),external:l(ct)(String((ue=l(s).external)==null?void 0:ue.gender)),internal:l(ct)(String(l(s).student.student_gender)),"always-show":oe.value,label:"Sexo/G\xEAnero",legend:"Atualizar sexo/g\xEAnero"},null,8,["modelValue","external","internal","always-show"]),v(ve,{modelValue:S.value.cpf,"onUpdate:modelValue":t[3]||(t[3]=g=>S.value.cpf=g),external:(me=l(s).external)==null?void 0:me.cpf,internal:l(s).student.student_cpf,label:"CPF",legend:"Atualizar CPF"},null,8,["modelValue","external","internal"]),v(ve,{modelValue:S.value.rg,"onUpdate:modelValue":t[4]||(t[4]=g=>S.value.rg=g),external:(X=l(s).external)==null?void 0:X.rg,internal:l(s).student.student_rg,"always-show":oe.value,label:"RG",legend:"Atualizar RG"},null,8,["modelValue","external","internal","always-show"]),v(ve,{modelValue:S.value.birthCertificate,"onUpdate:modelValue":t[5]||(t[5]=g=>S.value.birthCertificate=g),external:(xe=l(s).external)==null?void 0:xe.birthCertificate,internal:l(s).student.student_birth_certificate,"always-show":oe.value,label:"Certid\xE3o de nascimento",legend:"Atualizar certid\xE3o de nascimento"},null,8,["modelValue","external","internal","always-show"]),v(ve,{modelValue:S.value.phone,"onUpdate:modelValue":t[6]||(t[6]=g=>S.value.phone=g),external:(at=l(s).external)==null?void 0:at.phone,internal:l(s).student.student_phone||l(s).responsible.responsible_phone,"always-show":oe.value,label:"Telefone",legend:"Atualizar telefone"},null,8,["modelValue","external","internal","always-show"]),v(ve,{modelValue:S.value.mobile,"onUpdate:modelValue":t[7]||(t[7]=g=>S.value.mobile=g),external:(nt=l(s).external)==null?void 0:nt.mobile,internal:l(s).student.student_mobile||l(s).responsible.responsible_mobile,"always-show":oe.value,label:"Celular",legend:"Atualizar celular"},null,8,["modelValue","external","internal","always-show"]),v(ve,{modelValue:S.value.email,"onUpdate:modelValue":t[8]||(t[8]=g=>S.value.email=g),external:(rt=l(s).external)==null?void 0:rt.email,internal:l(s).student.student_email||l(s).responsible.responsible_email,"always-show":oe.value,label:"E-mail",legend:"Atualizar e-mail"},null,8,["modelValue","external","internal","always-show"]),v(ve,{modelValue:S.value.address,"onUpdate:modelValue":t[9]||(t[9]=g=>S.value.address=g),external:be.value,internal:Y.value,"always-show":oe.value,label:"Endere\xE7o",legend:"Atualizar endere\xE7o"},null,8,["modelValue","external","internal","always-show"])])])):(n(),d("div",il,[e("dl",dl,[t[39]||(t[39]=e("dt",{class:"font-hind font-size-10"},"Posi\xE7\xE3o",-1)),e("dd",null,u(l(s).position)+"\xBA",1)]),e("dl",ul,[t[40]||(t[40]=e("dt",{class:"font-hind font-size-10"},"Tipo",-1)),e("dd",null,[e("span",{class:ce([Pe(l(s).type),"badge"])},u(Ye(l(s).type)),3)])]),e("dl",cl,[t[41]||(t[41]=e("dt",{class:"font-hind font-size-10"},"S\xE9rie",-1)),e("dd",null,u(l(s).grade.name),1)]),e("dl",pl,[t[42]||(t[42]=e("dt",{class:"font-hind font-size-10"},"Turno",-1)),e("dd",null,u(l(s).period.name),1)]),e("dl",ml,[t[43]||(t[43]=e("dt",{class:"font-hind font-size-10"},"Fase escolar",-1)),e("dd",null,u(l(s).grade.course.name),1)]),e("dl",vl,[t[44]||(t[44]=e("dt",{class:"font-hind font-size-10"},"Escola",-1)),e("dd",null,u(l(s).school.name),1)]),e("dl",fl,[t[45]||(t[45]=e("dt",{class:"font-hind font-size-10"},"Data da solicita\xE7\xE3o",-1)),e("dd",null,u(l(I).formatDateTime(l(s).date)),1)]),l(s).inClassroom?(n(),d("dl",gl,[t[46]||(t[46]=e("dt",{class:"font-hind font-size-10"},"Turma pr\xE9-selecionada",-1)),e("dd",null,u(l(s).inClassroom.name),1)])):m("",!0)])),y.value==="SYNC"?(n(),d("div",bl,[e("div",El,[e("div",xl,[fe(e("input",{id:"always-show","onUpdate:modelValue":t[10]||(t[10]=g=>oe.value=g),type:"checkbox",class:"custom-control-input"},null,512),[[Qe,oe.value]]),t[47]||(t[47]=e("label",{for:"always-show",class:"custom-control-label font-size-10"}," Exibir todas as informa\xE7\xF5es ",-1))])])])):m("",!0),y.value==="SHOW"?(n(),d("div",hl,[l(s).waiting?(n(),d("div",yl,[e("div",_l,[t[51]||(t[51]=e("strong",null," Este aluno tamb\xE9m est\xE1 em lista de espera: ",-1)),e("div",wl,[e("dl",$l,[t[48]||(t[48]=e("dt",{class:"font-hind font-size-10"},"Protocolo",-1)),e("dd",null,[e("a",{href:"javascript:void(0)",onClick:t[11]||(t[11]=g=>Re(l(s).waiting.protocol))}," #"+u(l(s).waiting.protocol),1)])]),e("dl",Cl,[t[49]||(t[49]=e("dt",{class:"font-hind font-size-10"},"Posi\xE7\xE3o",-1)),e("dd",null,u(l(s).waiting.position)+"\xBA",1)]),e("dl",kl,[t[50]||(t[50]=e("dt",{class:"font-hind font-size-10"},"Escola",-1)),e("dd",null,u(l(s).waiting.school.name),1)])])])])):m("",!0),l(s).parent?(n(),d("div",Sl,[e("div",Tl,[t[55]||(t[55]=e("strong",null," Este(a) aluno(a) tamb\xE9m possui uma outra solicita\xE7\xE3o de matr\xEDcula: ",-1)),e("div",Vl,[e("dl",Al,[t[52]||(t[52]=e("dt",{class:"font-hind font-size-10"},"Protocolo",-1)),e("dd",null,[e("a",{href:"javascript:void(0)",onClick:t[12]||(t[12]=g=>Re(l(s).parent.protocol))}," #"+u(l(s).parent.protocol),1)])]),e("dl",Nl,[t[53]||(t[53]=e("dt",{class:"font-hind font-size-10"},"Posi\xE7\xE3o",-1)),e("dd",null,u(l(s).parent.position)+"\xBA",1)]),e("dl",Rl,[t[54]||(t[54]=e("dt",{class:"font-hind font-size-10"},"Escola",-1)),e("dd",null,u(l(s).parent.school.name),1)])])])])):m("",!0),l(s).others.length>0?(n(),d("div",Il,[e("div",zl,[t[60]||(t[60]=e("strong",null," O CPF v\xEDnculado a este(a) aluno(a) tamb\xE9m possui outras solicita\xE7\xF5es de matricula neste mesmo processo: ",-1)),(n(!0),d(we,null,ke(l(s).others,(g,Ke)=>(n(),d("dl",{key:Ke,class:"row mt-3"},[e("dl",Dl,[t[56]||(t[56]=e("dt",{class:"font-hind font-size-10"},"Protocolo",-1)),e("dd",null,[e("a",{href:"javascript:void(0)",onClick:za=>Re(g.protocol)}," # "+u(g.protocol),9,Pl)])]),e("dl",Ml,[t[57]||(t[57]=e("dt",{class:"font-hind font-size-10"},"Posi\xE7\xE3o",-1)),e("dd",null,u(g.position)+"\xBA",1)]),e("dl",Ol,[t[58]||(t[58]=e("dt",{class:"font-hind font-size-10"},"Escola",-1)),e("dd",null,u(g.school.name),1)]),e("dl",Ul,[t[59]||(t[59]=e("dt",{class:"font-hind font-size-10"},"Situa\xE7\xE3o",-1)),e("dd",null,[e("span",{class:ce(["badge",l(Ot)(g.status)])},u(l(je)(g.status)),3)])])]))),128))])])):m("",!0),(n(!0),d(we,null,ke(O.value.student,g=>(n(),d("dl",{key:g.id,class:"col-6"},[e("dt",jl,u(g.field.name),1),e("dd",null,u(ze(g,"STUDENT")),1)]))),128))])):m("",!0),y.value==="SHOW"?(n(),d(we,{key:11},[t[68]||(t[68]=e("h3",{class:"font-hind-18-primary mt-4"}," Dados do(a) respons\xE1vel pelo(a) aluno(a) ",-1)),t[69]||(t[69]=e("hr",null,null,-1)),e("div",Bl,[e("dl",Fl,[t[61]||(t[61]=e("dt",{class:"font-hind font-size-10"},"Rela\xE7\xE3o com o(a) aluno(a)",-1)),e("dd",null,u(Je(l(s).relationType)),1)])]),e("div",Ll,[(n(!0),d(we,null,ke(O.value.responsible,g=>(n(),d("dl",{key:g.id,class:"col-6"},[e("dt",Wl,u(g.field.name),1),e("dd",null,u(ze(g,"RESPONSIBLE")),1)]))),128))]),(n(!0),d(we,null,ke(l(s).responsible.responsible_address,(g,Ke)=>(n(),d("div",{key:Ke,class:"row"},[e("dl",Gl,[t[62]||(t[62]=e("dt",{class:"font-hind font-size-10"},"Endere\xE7o",-1)),e("dd",null,u(g.address),1)]),e("dl",Hl,[t[63]||(t[63]=e("dt",{class:"font-hind font-size-10"},"N\xFAmero",-1)),e("dd",null,u(g.number),1)]),g.complement?(n(),d("dl",ql,[t[64]||(t[64]=e("dt",{class:"font-hind font-size-10"},"Complemento",-1)),e("dd",null,u(g.complement),1)])):m("",!0),e("dl",Yl,[t[65]||(t[65]=e("dt",{class:"font-hind font-size-10"},"Bairro",-1)),e("dd",null,u(g.neighborhood),1)]),e("dl",Jl,[t[66]||(t[66]=e("dt",{class:"font-hind font-size-10"},"Cidade",-1)),e("dd",null,u(g.city),1)]),e("dl",Xl,[t[67]||(t[67]=e("dt",{class:"font-hind font-size-10"}," Foi alterado a localiza\xE7\xE3o manualmente? ",-1)),e("dd",null,u(g.manualChangeLocation?"Sim":"N\xE3o"),1)])]))),128)),e("div",null,[v(Ws,{items:R.value},null,8,["items"])])],64)):m("",!0),y.value==="SUMMON"?(n(),d("div",Zl,[t[70]||(t[70]=e("label",{class:"form-label",for:"summon-justification"},"Observa\xE7\xF5es (opcional)",-1)),fe(e("textarea",{id:"summon-justification","onUpdate:modelValue":t[13]||(t[13]=g=>f.value=g),class:"form-control",rows:"3"},null,512),[[Ue,f.value]])])):m("",!0),y.value==="REJECT"?(n(),d("div",Kl,[t[71]||(t[71]=e("label",{class:"form-label",for:"reject-justification"},"Justificativa (opcional)",-1)),fe(e("textarea",{id:"reject-justification","onUpdate:modelValue":t[14]||(t[14]=g=>f.value=g),class:"form-control",rows:"3"},null,512),[[Ue,f.value]])])):m("",!0),y.value==="ACCEPT"?(n(),d("div",Ql,[e("div",ea,[v(K,{modelValue:i.value,"onUpdate:modelValue":t[15]||(t[15]=g=>i.value=g),"container-class":"col-12",name:"classroom",rules:"required",label:"Para qual turma deseja designar o aluno(a)?",type:"SELECT",errors:w.value,options:l(k)},null,8,["modelValue","errors","options"])])])):m("",!0),w.value?(n(),d("div",ta,[e("h2",oa,u(te.value),1),e("span",{innerHTML:re.value},null,8,sa)])):m("",!0)])]}),footer:j(()=>[y.value==="SYNC"?(n(),d("div",la,[l(s).status==="ACCEPTED"?(n(),F(V,{key:0,color:"primary",outline:"",class:"ml-3 mr-3 mb-3 mb-lg-0",label:"Voltar","no-wrap":"","no-caps":"",onClick:t[16]||(t[16]=b=>y.value="SHOW")})):m("",!0),v(V,{loading:l(L),color:"primary",class:"ml-3 mr-3 mb-3 mb-lg-0",label:"Atualizar informa\xE7\xF5es","no-wrap":"","no-caps":"",onClick:We},null,8,["loading"]),l(s).status!=="ACCEPTED"?(n(),F(V,{key:1,loading:l(z),color:"primary",outline:"",class:"ml-3 mr-3 mb-3 mb-lg-0",label:"Continuar sem alterar informa\xE7\xF5es","no-wrap":"","no-caps":"","loading-normal":"",onClick:Ne},null,8,["loading"])):m("",!0)])):(n(),d("div",aa,[Fe.value?(n(),F(V,{key:0,loading:l(G),color:"summon",outline:"",class:"ml-2 mr-2 mb-2 mb-lg-0",label:"Convocar respons\xE1veis",icon:"pmd-summon","no-wrap":"","no-caps":"","loading-normal":"",onClick:Ze},null,8,["loading"])):m("",!0),Ee.value?(n(),F(V,{key:1,loading:l(P),color:"rejected",outline:"",class:"ml-2 mr-2 mb-2 mb-lg-0",label:"Indeferir",icon:"pmd-rejected","no-wrap":"","no-caps":"","loading-normal":"",onClick:de},null,8,["loading"])):m("",!0),T.value?(n(),F(V,{key:2,loading:l(C),color:"to-wait",outline:"",class:"ml-2 mr-2 mb-2 mb-lg-0",label:"Voltar para em espera",icon:"pmd-to-wait","no-wrap":"","no-caps":"","loading-normal":"",onClick:Ge},null,8,["loading"])):m("",!0),e("div",{class:"position-relative ml-2 mr-2 mb-2 mb-lg-0",onClick:t[20]||(t[20]=vt(()=>{},["stop"]))},[v(V,{ref_key:"dropdownBtnRef",ref:ie,color:"primary",outline:"",label:"Outras op\xE7\xF5es",icon:void 0,"icon-right":"mdi-chevron-down","no-wrap":"","no-caps":"",class:"w-100",style:{"min-width":"unset"},onClick:E},null,512),fe(e("div",{style:Vt([Te.value,{"min-width":"160px","max-width":"200px","z-index":"9999"}]),class:"bg-white border-radius-normal p-2 shadow-2 position-fixed"},[l(B).features.allowPreregistrationDataUpdate?(n(),d("div",{key:0,class:"dropdown-menu-item",onClick:t[17]||(t[17]=b=>o(De))}," Editar inscri\xE7\xE3o ")):m("",!0),Le.value?(n(),d("div",{key:1,class:"dropdown-menu-item",onClick:t[18]||(t[18]=b=>o(He))}," Atualizar dados ")):m("",!0),l(B).features.allowVacancyCertificate&&["ACCEPTED","SUMMONED"].includes(l(s).status)?(n(),d("div",{key:2,class:"dropdown-menu-item",onClick:t[19]||(t[19]=b=>o(pe))}," Emitir Atestado ")):m("",!0)],4),[[Tt,se.value]])]),N.value?(n(),F(V,{key:3,loading:l(z),color:"accepted",outline:"",class:"ml-2 mr-2 mb-2 mb-lg-0",label:"Deferir",icon:"pmd-accepted","no-wrap":"","no-caps":"","loading-normal":"",onClick:Ne},null,8,["loading"])):m("",!0)]))]),_:1},8,["modelValue","title","icon-right","tooltip-icon","initial-loading","persistent"]))}});const ia=ft(ra,[["__scopeId","data-v-4f4593b9"]]),ja=Object.freeze(Object.defineProperty({__proto__:null,default:ia},Symbol.toStringTag,{value:"Module"})),da={class:"m-auto",style:{"max-width":"740px"}},ua={class:"row mt-4"},ca={class:"col-6"},pa={class:"col-6"},ma={class:"col-6"},va={class:"col-6"},fa={class:"col-12"},ga={class:"col-12"},ba={class:"col-6"},Ea={key:0,class:"col-6"},xa={class:"row mb-4"},ha={class:"col-12"},ya={class:"col-12"},_a={class:"row"},wa={class:"row"},$a={class:"row"},Ca={class:"col-12"},ka={class:"row mb-4"},Sa={class:"col-12"},Ta={class:"col-12"},Va={class:"col-12"},Aa={class:"col-12"},Na={class:"d-flex flex-column flex-lg-row justify-content-center"},Ra={inheritAttrs:!1},Ia=Ae({...Ra,__name:"PreRegistrationEditModal",setup($e){const I=lt(),le=gt("$filters"),{loader:z,data:_}=Q({}),P=st(),A=ot(),C=p({responsible:[],student:[]}),h=p({}),k=p({}),D=p(!0),s=p([]),M=p([]),G=p([]),q=p([]),L=p("0"),W=p("0"),ae=()=>{A.push({name:"preregistration.modal",params:{protocol:P.params.protocol}})},{loader:B,loading:ne}=Q(),{loader:H,loading:O}=Q(),{loader:ge,loading:ee}=Q(),{loader:y,loading:f}=Q(),i=x=>{y(()=>ao({protocol:P.params.protocol,...x}))},w=x=>{B(()=>no({protocol:P.params.protocol,fields:Object.keys(x).map(r=>({field:r,value:x[r]&&x[r]!=="null"?String(x[r]):null}))}))},te=x=>{H(()=>ro({protocol:P.params.protocol,fields:Object.keys(x).map(r=>({field:r,value:x[r]&&x[r]!=="null"?String(x[r]):null}))}))},re=x=>{ge(()=>io({protocol:P.params.protocol,address:{...x.address,manualChangeLocation:!0}}))},ye=x=>{switch(x){case"REGISTRATION":return"Matr\xEDcula";case"REGISTRATION_RENEWAL":return"Rematr\xEDcula";case"WAITING_LIST":default:return"Lista de espera"}},oe=x=>{switch(x){case"REGISTRATION":return"badge-blue";case"REGISTRATION_RENEWAL":return"badge-cyan";case"WAITING_LIST":default:return"badge-yellow"}},Ce=x=>{!x||(_.value={},z(()=>_t({protocol:x,withVacancy:!0})).then(r=>{const{fields:Y,data:be}=xt(r.process),{fields:J,data:N}=ht(r.process);r.fields.filter(T=>T.field.group==="RESPONSIBLE").forEach(T=>{const Ee=`field_${T.field.id}`;be[Ee]=T.value}),r.fields.filter(T=>T.field.group==="STUDENT").forEach(T=>{const Ee=`field_${T.field.id}`;N[Ee]=T.value}),C.value.responsible=Y.sortBy("order"),h.value={...be,...r.responsible,responsible_place_of_birth:String(r.responsible.responsible_place_of_birth)},C.value.student=J.sortBy("order"),k.value={...N,...r.student,student_place_of_birth:String(r.student.student_place_of_birth)},L.value=r.responsible.responsible_address[0].lat,W.value=r.responsible.responsible_address[0].lng,s.value=r.process.grades.map(T=>({key:T.id,label:T.name})).sortBy("label"),M.value=r.process.periods.map(T=>({key:T.id,label:T.name})).sortBy("label"),G.value=r.process.schools.filter(T=>T.lat&&T.lng),q.value=r.process.vacancies}))},S=$(()=>G.value.filter(x=>{const r=q.value.filter(Y=>Number(Y.school)===Number(x.id));return _.value.grade.id&&_.value.period.id?r.find(Y=>Number(Y.school)!==Number(x.id)||Number(Y.grade)!==Number(_.value.grade.id)||Number(Y.period)!==Number(_.value.period.id)?!1:Number(Y.available)>=1):!0}).map(x=>({...x,position:{lat:x.lat,lng:x.lng}})).sortBy("label")),se=$(()=>S.value.map(x=>({key:x.id,label:x.name}))),Te=$(()=>S.value),ie=x=>{!x||(_.value.school.id=x.id)},_e=$(()=>({...Lt(),position:{lat:L.value,lng:W.value}})),Z=$(()=>P);return Se(Z,x=>{Ce(x.params.protocol)},{deep:!0}),Se(D,x=>{x||A.push({name:"preregistrations"})}),tt(()=>Ce(Z.value.params.protocol)),(x,r)=>{var Y,be;return(Y=l(_))!=null&&Y.student?(n(),F(Be,{key:0,modelValue:D.value,"onUpdate:modelValue":r[8]||(r[8]=J=>D.value=J),"title-class":"font-hind-18-primary text-uppercase text-primary",title:(be=l(_).student.student_name)!=null?be:"",large:!0,"loading-text":"",onCloseModal:r[9]||(r[9]=J=>x.$router.push({name:"preregistrations"}))},{body:j(()=>{var J;return[e("div",da,[e("div",ua,[e("dl",ca,[r[10]||(r[10]=e("dt",{class:"font-hind font-size-10"},"Posi\xE7\xE3o",-1)),e("dd",null,u(l(_).position)+"\xBA",1)]),e("dl",pa,[r[11]||(r[11]=e("dt",{class:"font-hind font-size-10"},"Tipo",-1)),e("dd",null,[e("span",{class:ce([oe(l(_).type),"badge"])},u(ye(l(_).type)),3)])]),e("dl",ma,[r[12]||(r[12]=e("dt",{class:"font-hind font-size-10"},"S\xE9rie",-1)),e("dd",null,u(l(_).grade.name),1)]),e("dl",va,[r[13]||(r[13]=e("dt",{class:"font-hind font-size-10"},"Turno",-1)),e("dd",null,u(l(_).period.name),1)]),e("dl",fa,[r[14]||(r[14]=e("dt",{class:"font-hind font-size-10"},"Fase escolar",-1)),e("dd",null,u(l(_).grade.course.name),1)]),e("dl",ga,[r[15]||(r[15]=e("dt",{class:"font-hind font-size-10"},"Escola",-1)),e("dd",null,u(l(_).school.name),1)]),e("dl",ba,[r[16]||(r[16]=e("dt",{class:"font-hind font-size-10"},"Data da solicita\xE7\xE3o",-1)),e("dd",null,u(l(le).formatDateTime(l(_).date)),1)]),l(_).inClassroom?(n(),d("dl",Ea,[r[17]||(r[17]=e("dt",{class:"font-hind font-size-10"},"Turma pr\xE9-selecionada",-1)),e("dd",null,u(l(_).inClassroom.name),1)])):m("",!0)]),e("div",xa,[e("div",ha,[v(Me,{onSubmit:i},{default:j(()=>[e("div",ya,[r[19]||(r[19]=e("h3",{class:"font-hind-18-primary mt-4"}," Editar dados da inscri\xE7\xE3o ",-1)),r[20]||(r[20]=e("hr",null,null,-1)),e("div",_a,[v(K,{modelValue:l(_).grade.id,"onUpdate:modelValue":r[0]||(r[0]=N=>l(_).grade.id=N),"container-class":"col-12 col-md-6",rules:"required",label:"S\xE9rie",name:"grade",type:"SELECT",options:s.value,searchable:!1},null,8,["modelValue","options"]),v(K,{modelValue:l(_).period.id,"onUpdate:modelValue":r[1]||(r[1]=N=>l(_).period.id=N),"container-class":"col-12 col-md-6",rules:"required",label:"Turno",name:"period",type:"SELECT",options:M.value,searchable:!1},null,8,["modelValue","options"])]),e("div",wa,[v(K,{modelValue:l(_).school.id,"onUpdate:modelValue":r[2]||(r[2]=N=>l(_).school.id=N),"container-class":"col-12",rules:"required",label:"Escola",name:"school",type:"SELECT",options:se.value,searchable:!1},null,8,["modelValue","options"])]),e("div",$a,[e("div",Ca,[v(Et,{bordered:""},{default:j(()=>[v(Ut,{config:l(I).map.config,lat:l(I).map.center.lat,lng:l(I).map.center.lng,zoom:l(I).map.zoom,style:{height:"400px"},tabindex:"-1"},{default:j(({map:N})=>[v(jt,{markers:Te.value,map:N,onClick:ie},{default:j(({marker:T})=>[e("div",null,[e("strong",null,u(T.name),1)])]),_:2},1032,["markers","map"]),v(Bt,{map:N,marker:_e.value},{default:j(()=>r[18]||(r[18]=[e("div",null,[e("strong",null,"Sua resid\xEAncia")],-1)])),_:2},1032,["map","marker"])]),_:1},8,["config","lat","lng","zoom"])]),_:1})])]),v(V,{loading:l(f),label:"Editar dados da inscri\xE7\xE3o","no-caps":"","no-wrap":"",color:"primary",class:"w-100 mt-3",type:"submit"},null,8,["loading"])])]),_:1})])]),e("div",ka,[e("div",Sa,[v(Me,{onSubmit:w},{default:j(()=>[e("div",Ta,[r[21]||(r[21]=e("h3",{class:"font-hind-18-primary mt-4"}," Editar dados do(a) aluno(a) ",-1)),r[22]||(r[22]=e("hr",null,null,-1)),v(pt,{fields:C.value.student,"onUpdate:fields":r[3]||(r[3]=N=>C.value.student=N),data:k.value,"onUpdate:data":r[4]||(r[4]=N=>k.value=N)},null,8,["fields","data"]),v(V,{loading:l(ne),label:"Editar dados do(a) aluno(a)","no-caps":"","no-wrap":"",color:"primary",class:"w-100",type:"submit"},null,8,["loading"])])]),_:1}),v(Me,{onSubmit:te},{default:j(()=>[e("div",Va,[r[23]||(r[23]=e("h3",{class:"font-hind-18-primary mt-4"}," Editar dados do(a) respons\xE1vel pelo(a) aluno(a) ",-1)),r[24]||(r[24]=e("hr",null,null,-1)),v(pt,{fields:C.value.responsible,"onUpdate:fields":r[5]||(r[5]=N=>C.value.responsible=N),data:h.value,"onUpdate:data":r[6]||(r[6]=N=>h.value=N)},null,8,["fields","data"]),v(V,{loading:l(O),label:"Editar dados do(a) respons\xE1vel pelo(a) aluno(a)","no-caps":"","no-wrap":"",color:"primary",class:"w-100",type:"submit"},null,8,["loading"])])]),_:1}),(J=h.value)!=null&&J.responsible_address?(n(),F(Me,{key:0,onSubmit:re},{default:j(({errors:N,setFieldValue:T})=>[e("div",Aa,[r[25]||(r[25]=e("h3",{class:"font-hind-18-primary mt-4"}," Editar dados do(a) endere\xE7o do respons\xE1vel pelo(a) aluno(a) ",-1)),v(Ft,{data:h.value.responsible_address[0],"onUpdate:data":r[7]||(r[7]=Ee=>h.value.responsible_address[0]=Ee),"fetching-address-lat-lng":!1,"set-field-value":T,errors:N,name:"address"},null,8,["data","set-field-value","errors"]),v(V,{loading:l(ee),label:"Editar dados do(a) endere\xE7o do respons\xE1vel pelo(a) aluno(a)","no-caps":"","no-wrap":"",color:"primary",class:"w-100",type:"submit"},null,8,["loading"])])]),_:1})):m("",!0)])])])]}),footer:j(()=>[e("div",Na,[v(V,{color:"primary",outline:"",class:"ml-3 mr-3 mb-3 mb-lg-0",label:"Voltar","no-wrap":"","no-caps":"","loading-normal":"",onClick:ae})])]),_:1},8,["modelValue","title"])):m("",!0)}}}),Ba=Object.freeze(Object.defineProperty({__proto__:null,default:Ia},Symbol.toStringTag,{value:"Module"}));export{Ua as P,ja as a,Ba as b};
